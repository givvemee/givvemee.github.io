---
layout: post
Title: How did i resolve react CORS issue 
tags: [daily]
categories: life
---

### 리액트 웹 사이트 프로젝트를 만들면서 만난 이슈! CORS!

요즘 포트폴리오에 쌓을 것들을 하나하나씩 만들고 있다. 그래도 리액트랑 타입스크립트 공부 중이니까 그걸로 만든 무언가를 직접 제작해 보고 싶어서. 
어쨌거나, 그래서 유명한 도서 사이트에서 제공하는 api 를 가져와서 베스트 셀러 노출, 책 검색, 책 추천 등의 프로젝트를 만들고 있다. 그런데 api 를 쓰는데 로컬호스트에서 노출이 안 되더니, 

![image](https://user-images.githubusercontent.com/89691274/144436052-bab013f5-1f5b-4370-8419-8fab83e7f851.png)

이런 메시지가 뜨는 것이다. 
그래서 저 메시지를 그대로 구글링 해 봤더니, CORS 라는 것 때문이었다. 

만일 이 포스트를 보는 사람이 CORS 가 궁금하다면 그게 뭔지는 직접 검색해 보면 좋을 것 같고, 내가 이해한 바로는 내가 사용하고 있는 api 주소와 api 를 끌어다 쓰는 주소(현재 경우에는 로컬호스트) 가 일치하지 않아서 발생하는 문제라고 한다. 
<br/>
찾아 보니 백엔드 통해 미들웨어로 따로 서버 주소를 연결해 주면 된다고 한다. 이게 그 방법을 아는 사람에게는 가장 쉬운 방법이겠지만 나는 프론트엔드만 아는 사람이라서 다른 방법을 열심히 찾아 보았다.

**그래서 어떻게 해결을 했냐면...**
이 포스트를 쓰고 있는 시점에서는 3가지 방법을 사용했고, 언제가 되었든 나중 되면 그게 안 될 수도 있다. 
1. proxy 활용
원리는 잘 모르겠으나, proxy 로 api 의 홈 주소를 따로 설정해 주는 방법이 있다.
만약 내가 쓰는 api 주소가 http://www.api홈주소.com/myApiKey/Queryblacblah 의 형식이라고 가정해 보자. 먼저 `package.json` 에 아래와 같은 것을 추가한다.
```
... 
"proxy" : "http//www.api의홈주소.com/"
```
그런 다음에 내가 현재 쓰고 있는 api 를 노출시키는 컴포넌트에 
```
const api = 'http://www.api홈주소.com/myApiKey/Queryblacblah'
```
이렇게 쓰여 있는 주소를 proxy 에서 따로 뺀 부분만 넣는다.
```
const api = 'myApiKey/Queryblacblah'
```
라고 하면 엄청나게 복잡하지 않은 주소라면 가능할 확률이 높다. 
<br/>
2. Chrome Extension 활용
크롬 자체에 CORS 이슈를 일어나지 않게 해 주는 확장 프로그램이 있다. 종류가 다양한데 내가 써본 것은 아래 두 개.
![image](https://user-images.githubusercontent.com/89691274/144438012-bfca18c8-0156-4efe-9da1-1b2bc803df1c.png)
![image](https://user-images.githubusercontent.com/89691274/144438052-56acd2d6-9277-4d87-b812-1dc04412cf68.png)
첫 번째 거는 가장 처음으로 접한 건데 아주 편하다! 근데 진짜 진짜 치명적인 단점은 .... 유튜브에서 오류가 난다. 왜인지 모름. 그래서 결국 저거 쓰다가 삭제하고 새로 설치한 게 두번째 거. 
두 번째 거는 토글 기능으로 편하게 켰다 껐다 할 수 있다. 
물론! 이건 내 로컬호스트에서 볼 땐 진짜 진짜 편한데, 나는 나의 프로젝트를 깃허브에 올려 배포해야 했으니 다른 선택지가 필요했다. 확장 프로그램이 설치된 내 컴퓨터에서는 잘 보이는데 깃허브에 리액트 npm run deploy 하면 보이지 않는 건 매한가지라서.
<br/>
3. https://cors-anywhere.herokuapp.com/
그래서 찾은 게 위의 사이트. 이건 사용 방법이 비교적 간단하다. 
먼저 해당 사이트로 가 Request 어쩌고 버튼을 누른다. 그런 다음 나의 프로젝로 돌아와 api 가 있는 컴포넌트에 아래처럼 앞에 주소만 넣으면 된다.
```
const api = 'https://cors-anywhere.herokuapp.com/http://www.api홈주소.com/myApiKey/Queryblacblah'
```
그럼 자동으로 우회? 의 개념으로 잘 보이게 해 주는 것 같다. 이거는 예전에는 상시 사용이 가능했었댄다. 즉, request 버튼을 따로 안 눌렀어도 되었다는 말. 근데 저 레포지토리를 읽어보니 이 기능이 Requeest 버튼을 누르고 1시간에서 50시간 사이 랜덤하게 자동으로 꺼지는 것 같다. 그러니 수시로 확인하고 다시 켜 주어야 한다는 말.
어떻게 보면.... 가장 불편한 선택지이긴 하다. 그래도 현재로써는 방법이 있다는 것에 대해 감사하면서 사용하는 중.
<br/>
물론 나중엔 node.js 로 이 문제를 해결하는 포스팅도 올릴 것이다. 언제가 될지는 모르지만. ㅎ

<br/>

<br/>